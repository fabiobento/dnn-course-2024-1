Agora que você viu como a distribuição gaussiana ou normal funciona para um único número, estamos prontos para criar nosso algoritmo de detecção de anomalias. Vamos mergulhar. Você tem um conjunto de treinamento de x1 a xm, onde aqui cada exemplo x tem características finais. Então, cada exemplo x é um vetor dentro de números. No caso do exemplo do motor do avião, tínhamos duas características correspondentes ao calor e às vibrações. E assim, cada um desses excisos seria um vetor bidimensional e n seria igual a 2. Mas, para muitas aplicações práticas, n pode ser muito maior e você pode fazer isso com dezenas ou até centenas de recursos. Dado esse conjunto de treinamento, o que gostaríamos de fazer é realizar uma estimativa de densidade e tudo o que isso significa é que construiremos um modelo ou estimaremos a probabilidade de p (x). Qual é a probabilidade de um determinado vetor de características? E nosso modelo para p (x) será o seguinte, x é um vetor de características com valores x1, x2 e assim por diante até xn. E vou modelar p (x) como a probabilidade de x1, vezes a probabilidade de x2, vezes a probabilidade de x3 vezes a probabilidade de xn, para as n ésimas características nos vetores de características. Se você já fez uma aula avançada de provavelmente estatística antes, pode reconhecer que essa equação corresponde à suposição de que as características x1, x2 e assim por diante até xm são estatisticamente independentes. Mas acontece que esse algoritmo geralmente funciona bem, mesmo que os recursos não sejam estatisticamente independentes. Mas se você não entendeu o que eu acabei de dizer, não se preocupe. Não é necessário compreender a independência física para concluir totalmente a discussão e também ser capaz de usar de forma muito eficaz o algoritmo de detecção de anomalias. Agora, para preencher essa equação um pouco mais, estamos dizendo que a probabilidade de todas as características desse vetor terem x é o produto de p (x) 1 e p (x2) e assim por diante até p (xn). E para modelar a probabilidade de x1, digamos que a característica de calor neste exemplo, teremos dois parâmetros, novo 1 e sigma 1 ou sigma quadrado é 1. E o que isso significa é que vamos estimar a média do recurso x1 e também a variância do recurso x1, que serão os novos 1 e sigma 1. O modelo p (x2) x2 é uma característica totalmente diferente que mede as vibrações do motor do avião. Teremos dois parâmetros diferentes, que escreverei como mu 2, sigma 2 ao quadrado. E acontece que isso corresponderá à média ou média do recurso de vibração e à variação do recurso de vibração e assim por diante. Se você tiver recursos adicionais, mu 3 sigma 3 ao quadrado até mu n e sigma n ao quadrado. Caso você esteja se perguntando por que multiplicamos probabilidades, talvez aqui esteja um exemplo que possa criar intuição. Suponha que, para um motor de aeronave, haja 1/10 de chance de estar muito quente, excepcionalmente quente e talvez haja uma chance em 20 de que ele vibre com muita força. Então, qual é a chance de ele ficar muito quente e vibrar com muita força. Estamos dizendo que a chance disso é 1/10 vezes 1/20, que é 1/200. Portanto, é muito improvável que haja um motor que esteja muito quente nas duas frentes e vibre com muita força. É o produto dessas duas probabilidades. Uma maneira um pouco mais compacta de escrever essa equação aqui
Reproduza o vídeo começando em :4:23 e siga a transcrição4:23
é dizer que isso é igual ao produto de j = 1 a n de p (xj).
Reproduza o vídeo começando em :4:38 e siga a transcrição4:38
Os parâmetros mu j e sigma seriam quadrados em j. E esse símbolo aqui é muito parecido com o símbolo de soma, exceto que, enquanto o símbolo de soma corresponde à adição, esse símbolo aqui corresponde à multiplicação desses termos aqui por j =1 a n. Então, vamos juntar tudo para ver como você pode construir um sistema de detecção de nomeados. A primeira etapa é escolher os recursos xi que você acha que podem ser indicativos de exemplos anômalos. Depois de criar os recursos que deseja usar, você ajustaria os parâmetros mu 1 a mu n e sigma quadrado 1 a sigma quadrado n, para os n recursos em seu conjunto de dados. Como você pode imaginar, o parâmetro mu j será apenas a média de xj do recurso j de todos os exemplos em seu conjunto de treinamento. E sigma square j será a média da diferença quadrada entre a característica e o valor mu j, que você acabou de calcular. E, a propósito, se você tiver uma implementação vetorizada, você também pode calcular mu como a média dos exemplos de treinamento da seguinte forma, estamos aqui, x e mu são ambos vetores. Então, essa seria a forma vetorizada de calcular mu 1 a mu e tudo ao mesmo tempo. E ao estimar esses parâmetros em seu conjunto de treinamento não rotulado, agora você calculou todos os parâmetros do seu modelo. Finalmente, quando você receber um novo exemplo, teste x ou eu vou escrever um novo exemplo como x aqui, o que você faria seria calcular p (x) e ver se é grande ou pequeno. Portanto, p (x), como você viu no último slide, é o produto de j = 1 a n da probabilidade das características individuais. Então p (x) j com parâmetros mu j e quadrado único j. E se você substituir in, a fórmula para essa probabilidade, você acaba com essa expressão 1 sobre raiz 2 pi sigma j de e para esta expressão aqui. Então xj são os recursos, esse é um recurso j do seu novo exemplo, mu j e sigma j são números ou parâmetros que você calculou na etapa anterior. E se você calcular essa fórmula, obterá algum número para p (x).
Reproduza o vídeo começando em :7:19 e siga a transcrição7:19
E a etapa final é ver que p (x) é menor que épsilon. E se for, então você sinaliza que é uma anomalia. Uma
Reproduza o vídeo começando em :7:29 e siga a transcrição7:29
intuição por trás do que este álbum está fazendo é que ele tenderá a sinalizar um exemplo como anômalo se 1 ou mais dos recursos forem muito grandes ou muito pequenos em relação ao que foi visto no conjunto de treinamento. Então, para cada uma das características x j, você está ajustando uma distribuição gaussiana como esta. Então, se pelo menos uma das características do novo exemplo estivesse aqui, digamos, então P f xJ seria muito pequeno. E se apenas 1 dos termos deste produto for muito pequeno, esse produto geral, quando você multiplicar, tenderá a ser muito pequeno e p (x) será pequeno. E o que a detecção de anomalias está fazendo com o algoritmo é uma forma sistemática de quantificar se esse novo exemplo x tem ou não alguma característica que seja incomumente grande ou incomumente pequena. Agora, vamos dar uma olhada no que tudo isso realmente significa em 1 exemplo. Aqui está o conjunto de dados com recursos x 1 e x 2.
Reproduza o vídeo começando em :8:39 e siga a transcrição8:39
E você percebe que os recursos x 1 assumem uma faixa de valores muito maior do que os recursos x 2.
Reproduza o vídeo começando em :8:48 e siga a transcrição8:48
Se você fosse computar o meme do Features x 1, você acabaria com cinco, e é por isso que você quer que seja igual a 1. E acontece que, para esses dados, dito, se você computar o sigma 1, ele será igual a cerca de 2. E se você calculasse mu até que a média das características ao lado da média é três e, da mesma forma, a variância ou o desvio padrão é muito menor, é por isso que Sigma 2 é igual a 1. Então isso corresponde a essa distribuição gaussiana para x 1 e essa distribuição gaussiana para x 2. Se você realmente multiplicasse p (x) 1 e p (x) 2, então você acabaria com este gráfico de superfície de três D para p (x) onde qualquer ponto, sua altura é o produto de p (x) 1 vezes p (x) 2. Para os valores correspondentes de x 1 e x 2. E isso significa que valores em que p (x) é maior ou mais provável. Portanto, valores próximos ao meio daqui são mais prováveis. Enquanto valores distantes aqui, valores aqui fora são muito menos prováveis. Eu tenho uma chance muito menor.
Reproduza o vídeo começando em :10:5 e siga a transcrição10:05
Agora, deixe-me escolher exemplos de teste, o primeiro 1 aqui, vou escrever esse x teste 1 e o segundo 1 aqui embaixo como x teste 2. E vamos ver quais desses dois exemplos o álbum sinalizará como anômalos.
Reproduza o vídeo começando em :10:22 e siga a transcrição10:22
Vou escolher o parâmetro ε para ser igual a 0,02. E se você fosse calcular o teste p (x) 1, ele seria cerca de 0,4 e isso é muito maior do que épsilon. E então o álbum dirá que isso parece bom, não parece uma anomalia. Por outro lado, se você computasse p (x) para este ponto aqui embaixo, correspondente a x 1 é igual a cerca de oito e x 2 é igual a cerca de 0,5.
Reproduza o vídeo começando em :10:58 e siga a transcrição10:58
Mais ou menos aqui embaixo, então o teste p (x) 2 é 0,0021. Então, isso é muito menor do que épsilon. E assim, o álbum sinalizará isso como uma provável anomalia. Então, por mais que você espere, ele decide que o teste x 1 parece bastante normal. Já o excesso está muito mais distante do que qualquer coisa que você vê no conjunto de treinamento, parece que pode ser uma anomalia. Então você viu o processo de como construir um sistema de detecção de anomalias. Mas como você escolhe o parâmetro épsilon? E como saber se seu sistema de detecção de anomalias está funcionando bem? No próximo vídeo, vamos nos aprofundar um pouco mais no processo de desenvolvimento e avaliação do desempenho de um sistema de detecção de anomalias. Vamos para o próximo vídeo
Obrigatória
pt-BR
​

