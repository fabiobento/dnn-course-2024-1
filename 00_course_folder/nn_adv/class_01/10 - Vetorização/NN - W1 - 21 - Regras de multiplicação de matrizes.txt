Então, vamos dar uma olhada na forma geral de como você multiplica duas matrizes. E então, no último vídeo após este, vamos pegar isso e aplicá-lo à implementação vetorizada de uma rede neural. Vamos mergulhar. Aqui está a matriz A, que é uma matriz 2 por 3 porque tem duas linhas e três colunas. Como antes, encorajo você a pensar nas colunas dessa matriz como três vetores, vetores a1, a2 e a3. E o que vamos fazer é pegar a transposição A e multiplicá-la pela matriz W. A primeira, o que é a transposição A? Bem, uma transposição é obtida pegando a primeira coluna de A e colocando-a do lado assim e depois pegando a segunda coluna de A e deitando do lado dele assim. E então a terceira coluna de A e deitada de lado assim. E então essas linhas agora são transposta A1, transposição A2 e transposição A3. A seguir, aqui está a matriz W. Eu encorajo você a pensar em W como fatores w1, w2, w3 e w4 empilhados juntos. Então, vamos ver como você calcula a transposição de A vezes W. Agora, observe que eu também usei tons de laranja ligeiramente diferentes para denotar as diferentes colunas de A, onde a mesma tonalidade corresponde a números que consideramos agrupados em um vetor. E essa mesma tonalidade é usada para indicar diferentes funções da transposição A porque as diferentes funções da transposição A são a transposição A1, a transposição A2 e a transposição A3. E de forma semelhante, usei tons diferentes para denotar as diferentes colunas de W. Como os números têm o mesmo tom de azul, são aqueles que são agrupados para formar os vetores w1, w 2, w3 ou w4. Agora, vamos ver como você pode calcular A transposição vezes W. Vou desenhar arcos verticais em diferentes tons de azul e barras horizontais com os diferentes tons de laranja para indicar quais elementos de Z que é A transposição W são influenciados ou afetados pelas diferentes funções da transposição A e quais são influenciados ou afetados pelas diferentes colunas de W. Então, por exemplo, vamos ver a primeira coluna de W. Então, isso é w1 conforme indicado pelo tom mais claro de azul aqui. Portanto, w1 influenciará ou corresponderá a esta primeira coluna de Z mostrada aqui por esse tom mais claro de azul. E os valores dessa segunda coluna de W que é w2, conforme indicado por esse segundo tom mais claro de azul, afetarão os valores calculados na segunda coluna de Z e assim por diante para a terceira e quarta colunas.
Reproduza o vídeo começando em :3:18 e siga a transcrição3:18
Da mesma forma, vamos dar uma olhada em A transpose. A transposição A1 é a primeira linha da transposição A, conforme indicado pelo tom mais claro de laranja, e a transposição A1 afetará, influenciará ou corresponderá aos valores na primeira linha de Z. E a transposição A2 influenciará a segunda linha de Z e os transportes A3 influenciarão ou corresponderão a essa terceira linha de Z. Então, vamos descobrir como calcular a matriz Z, que será uma matriz 3 por 4. Então, com 12 números no total. Vamos começar e descobrir como calcular o número na primeira linha, na primeira coluna de Z. Então, essa parte superior esquerda é a maioria dos elementos aqui porque esta é a primeira linha e a primeira coluna correspondentes ao tom mais claro de laranja e ao tom mais claro de azul. A maneira de calcular isso é pegar a primeira linha de uma transposição e a primeira coluna de W e pegar seu produto interno ou o produto. E então esse número será (1,2) produto pontual com (3,4) que é (1 * 3) + (2 * 4) = 11. Vejamos o segundo exemplo. Como você calcularia esse elemento de Z. Então, isso está na terceira linha, linha 1, linha 2, linha 3. Então, isso está na linha 3 e na segunda coluna, coluna 1, coluna 2. Então, para calcular o número na linha 3, coluna 2 de Z, agora você pegaria a linha 3 da transposição A e a coluna 2 de W e o ponto as produziria juntas. Observe que isso corresponde ao tom mais escuro de laranja e ao segundo tom mais claro de azul. E para calcular isso, isso é (0,1 * 5) + (0,2 * 6), que é (0,5 + 1,2), que é igual a 1,7. Então, para calcular o número na linha 3, coluna 2 de Z, você pega a terceira linha, a linha 3 de uma transposição e a coluna 2 de W. Vamos ver mais um exemplo e ver se você consegue descobrir esse. Esta é a linha 2, coluna 3 da matriz Z. Por que você não dá uma olhada e vê se consegue descobrir qual linha e qual coluna juntar o produto pontual e , portanto, qual é o número que aparecerá nesse elemento dessa matriz? Espero que você tenha entendido isso. Você deve pegar a linha 2 da transposição A e a coluna 3 de W. E quando você pontilha o produto que, juntos, você tem a transposição A2, w3 é (-1 * 7) + (-2 * 8), que é (-7 + -16), que é igual a -23. E é assim que você calcula esse elemento da matriz Z. E acontece que, se você fizer isso para cada elemento da matriz Z, poderá calcular todos os números dessa matriz que acabam ficando assim. Sinta-se à vontade para pausar o vídeo se quiser e escolher os elementos e verificar se a fórmula que estamos usando fornece o valor certo para Z. Eu só quero destacar um último requisito interessante para multiplicar matrizes, que é que a transposição X aqui é uma matriz 3 por 2 porque tem 3 linhas e 2 colunas, e W aqui é uma matriz 2 por 4 porque tem 2 linhas e 4 colunas. Um requisito para multiplicar duas matrizes é que esse número corresponda a esse número. E isso porque você só pode usar produtos pontuais entre vetores com o mesmo comprimento. Assim, você pode pegar o produto pontual entre um vetor com dois números. E isso porque você pode pegar o produto interno entre o vetor de comprimento 2 somente com outro vetor de comprimento 2. Você não pode colocar o produto interno entre o vetor de comprimento 2 com um vetor de comprimento 3, por exemplo. E é por isso que a multiplicação de matrizes é válida somente se o número de colunas da primeira matriz, ou seja, A transposta aqui for igual ao número de rolos da segunda matriz, que é o número de rolos de W aqui. Assim, quando você pega produtos pontuais durante esse processo, você está pegando produtos pontuais de vetores do mesmo tamanho. E então a outra observação é que a saída Z é igual a uma transposição, W. As dimensões de Z são 3 por 4. Portanto, a saída dessa multiplicação terá o mesmo número de linhas da transposição X e o mesmo número de colunas que W. E, portanto, essa também é outra propriedade da multiplicação de matrizes. Então, isso é multiplicação de matrizes. Todos esses vídeos são opcionais. Então, obrigado por ficar comigo durante esses momentos. E se você estiver interessado no final desta semana, também há alguns questionários puramente opcionais para permitir que você pratique mais desses cálculos sozinho. Um pouco disso, vamos pegar o que aprendemos sobre multiplicação de matrizes e aplicar de volta à implementação vetorizada de uma rede neural. Devo dizer que a primeira vez que entendi a implementação vetorizada, achei realmente muito legal. Eu mesmo venho implementando redes neurais há algum tempo sem a implementação vetorizada. E quando finalmente entendi a implementação vetorizada e a implementei dessa forma pela primeira vez, ela funcionou incrivelmente mais rápido do que qualquer coisa que eu já fiz antes. E eu pensei, uau, eu gostaria de ter descoberto isso antes. A implementação vetorizada é um pouco complicada, mas faz com que suas redes funcionem muito mais rápido. Então, vamos dar uma olhada nisso no próximo vídeo.
