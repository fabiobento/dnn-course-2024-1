No último vídeo, você aprendeu sobre o modelo de regressão logística. Agora, vamos dar uma olhada no limite de decisão para ter uma ideia melhor de como a regressão logística está computando essas previsões. Recapitulando, veja como as saídas dos modelos de regressão logística são calculadas em duas etapas. Na primeira etapa, você calcula z como w.x mais b. Em seguida, você aplica a função sigmóide g a esse valor z. Aqui, novamente, está a fórmula para a função sigmóide.
Reproduza o vídeo começando em ::38 e siga a transcrição0:38
Outra forma de escrever isso é dizer que f de x é igual a g, a função sigmóide, também chamada de função logística, aplicada a w.x mais b, onde isso é, obviamente, o valor de z. Se você pegar a definição da função sigmóide e inserir a definição de z, então você descobre que f de x é igual a esta fórmula aqui, 1 sobre 1 mais e para menos z, onde z é wx mais b. Você deve se lembrar que dissemos no vídeo anterior que interpretamos isso como a probabilidade de y ser igual a 1 dado x e com parâmetros w e b. Esse será um número como talvez 0,7 ou 0,3. Agora, e se você quiser aprender o algoritmo para prever. O valor de y será zero ou um? Bem, uma coisa que você pode fazer é definir um limite acima do qual você prevê que y é um, ou definir y hat como uma previsão igual a um e abaixo do qual você pode dizer que y hat, minha previsão será igual a zero. Uma escolha comum seria escolher um limite de 0,5 para que, se f de x for maior ou igual a 0,5, predizer que y é um. Escrevemos essa previsão como y que é igual a 1, ou se f de x for menor que 0,5, predizer y é 0 ou, em outras palavras, a previsão y hat é igual a 0. Agora, vamos nos aprofundar em quando o modelo prediria um. Em outras palavras, quando f de x é maior ou igual a 0,5. Lembraremos que f de x é igual a g de z. Então f é maior ou igual a 0,5 sempre que g de z é maior ou igual a 0,5. Mas quando g de z é maior ou igual a 0,5? Bem, aqui está uma função sigmóide. Portanto, g de z é maior ou igual a 0,5 sempre que z é maior ou igual a 0. Isso é sempre que z está na metade direita desse eixo. Finalmente, quando z é maior ou igual a zero? Bem, z é igual a w.x mais b, então z é maior ou igual a zero sempre que w.x mais b é maior ou igual a zero. Recapitulando, o que você viu aqui é que o modelo prevê 1 sempre que w.x mais b é maior ou igual a 0. Por outro lado, quando w.x mais b é menor que zero, o algoritmo prevê que y é 0. Diante disso, vamos agora visualizar como o modelo faz previsões. Vou dar um exemplo de um problema de classificação em que você tem dois recursos, x1 e x2, em vez de apenas um recurso. Aqui está um conjunto de treinamento em que as pequenas cruzes vermelhas indicam os exemplos positivos e os pequenos círculos azuis indicam os exemplos negativos. As cruzes vermelhas correspondem a y igual a 1 e os círculos azuis correspondem a y igual a 0.
Reproduza o vídeo começando em :4:22 e siga a transcrição4:22
O modelo de regressão logística fará previsões usando essa função f de x é igual a g de z, onde z agora é essa expressão aqui, w1x1 mais w2x2 mais b, porque temos duas características x1 e x2. Digamos, neste exemplo, que o valor dos parâmetros seja w1 igual a 1, w2 igual a 1 e b igual a menos 3. Vamos agora dar uma olhada em como a regressão logística faz previsões. Em particular, vamos descobrir quando wx mais b é maior que igual a 0 e quando wx mais b é menor que 0. Para descobrir isso, há uma linha muito interessante a ser observada, que é quando wx mais b é exatamente igual a 0. Acontece que essa linha também é chamada de limite de decisão porque é a linha em que você é quase neutro sobre se y é 0 ou y é 1. Agora, para os valores dos parâmetros w_1, w_2 e b que escrevemos acima, esse limite de decisão é apenas x_1 mais x_2 menos 3. Quando x_1 mais x_2 menos 3 é igual a 0? Bem, isso corresponderá à linha x_1 mais x_2 igual a 3, e essa é a linha mostrada aqui. Essa linha acaba sendo o limite de decisão, onde se as características x estiverem à direita dessa linha, a regressão logística prediria 1 e à esquerda dessa linha, a regressão logística com prediz 0. Em outras palavras, o que acabamos de visualizar é o limite de decisão para regressão logística quando os parâmetros w_1, w_2 e b são 1,1 e menos 3. Obviamente, se você tivesse uma escolha diferente dos parâmetros, o limite de decisão seria uma linha diferente. Agora, vamos ver um exemplo mais complexo em que o limite de decisão não é mais uma linha reta. Como antes, as cruzes indicam que a classe y é igual a 1 e os pequenos círculos indicam que a classe y é igual a 0. No início da semana passada, você viu como usar polinômios na regressão linear e pode fazer o mesmo na regressão logística.
Reproduza o vídeo começando em :7:11 e siga a transcrição7:11
Isso define z como w_1, x_1 ao quadrado mais w_2, x_2 ao quadrado mais b. Com essa escolha de características, características polinomiais se transformam em uma regressão logística. F de x, que é igual a g de z, agora é g dessa expressão aqui. Digamos que acabamos escolhendo w_1 e w_2 como 1 e b como menos 1. Z é igual a 1 vezes x_1 ao quadrado mais 1 vezes x_2 ao quadrado menos 1. O limite de decisão, como antes, corresponderá a quando z for igual a 0. Essa expressão será igual a 0 quando x_1 ao quadrado mais x_2 ao quadrado for igual a 1.
Reproduza o vídeo começando em :8: e siga a transcrição8:00
Se você traçar no diagrama à esquerda, a curva correspondente a x_1 ao quadrado mais x_2 ao quadrado é igual a 1, isso acaba sendo o círculo. Quando x_1 ao quadrado mais x_2 ao quadrado é maior ou igual a 1, essa é a área fora do círculo e é aí que você prevê que y seja 1. Por outro lado, quando x_1 ao quadrado mais x_2 ao quadrado é menor que 1, essa é a área dentro do círculo e é quando você prevê que y seja 0. Podemos criar limites de decisão ainda mais complexos do que esses? Sim, você pode. Você pode fazer isso usando termos polinomiais de ordem ainda mais alta.
Reproduza o vídeo começando em :8:44 e siga a transcrição8:44
Digamos que z seja w_1, x_1 mais w_2, x_2 mais w_3, x_1 ao quadrado mais w_4, x_1, x_2 mais w_5, x_2 ao quadrado. Então, é possível que você consiga limites de decisão ainda mais complexos. O modelo pode definir limites de decisão, como neste exemplo, uma elipse como essa ou com uma escolha diferente dos parâmetros. Você pode até mesmo obter limites de decisão mais complexos, que podem parecer funções que talvez se pareçam com isso. Portanto, este é um exemplo de um limite de decisão ainda mais complexo do que os que vimos anteriormente. Essa implementação de regressão logística predirá que y é igual a 1 dentro dessa forma e fora da forma preverá que y é igual a 0. Com essas características polinomiais, você pode obter limites de decisão muito complexos. Em outras palavras, a regressão logística pode aprender a ajustar dados bastante complexos.
Reproduza o vídeo começando em :9:47 e siga a transcrição9:47
Porém, se você não incluísse nenhum desses polinômios de ordem superior, se os únicos recursos usados fossem x_1, x_2, x_3 e assim por diante, o limite de decisão para regressão logística sempre será linear, sempre será uma linha reta. No próximo laboratório opcional, você também verá a implementação do código do limite de decisão. No exemplo do laboratório, haverá dois recursos para que você possa ver esse limite de decisão como uma linha. Com essa visualização, espero que agora você tenha uma noção da variedade de modelos possíveis que você pode obter com a regressão logística. Agora que você viu o que f de x pode potencialmente computar, vamos dar uma olhada em como você pode realmente treinar um modelo de regressão logística. Começaremos analisando a função de custo para regressão logística e, depois disso, descobriremos como aplicar o gradiente descendente a ela. Vamos para o próximo vídeo.
